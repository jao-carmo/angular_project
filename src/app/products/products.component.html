<div class="products-wrapper">
  <!-- Animated background -->
  <div class="animated-bg">
    <div class="circle circle-1"></div>
    <div class="circle circle-2"></div>
  </div>

  <div class="products-container">
    <!-- Header Section -->
    <div class="header-section">
      <div class="header-left">
        <button mat-icon-button routerLink="/" class="back-button">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M19 12H5M12 19l-7-7 7-7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </button>
        <div class="header-title">
          <h1>Meus Produtos</h1>
          <p class="subtitle">Gerencie seu catálogo completo</p>
        </div>
      </div>
      <div class="header-actions">
        <button mat-stroked-button routerLink="/cart" class="cart-button">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M9 20a1 1 0 1 0 0 2 1 1 0 0 0 0-2zM20 20a1 1 0 1 0 0 2 1 1 0 0 0 0-2z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          Carrinho
          <span class="cart-count" *ngIf="cartItemCount() > 0">{{ cartItemCount() }}</span>
        </button>
        <button mat-raised-button color="primary" (click)="openDialog()" class="add-button">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
            <path d="M12 8v8M8 12h8" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
          Novo Produto
        </button>
      </div>
    </div>

    <!-- Products Grid -->
    <div class="products-grid" *ngIf="products.length > 0">
      <div *ngFor="let product of products; let i = index" 
           class="product-card"
           [style.animation-delay]="(i * 0.05) + 's'">
        <div class="product-image-wrapper">
          <img 
            [src]="product.imageUrl || 'https://via.placeholder.com/300?text=Sem+Imagem'" 
            [alt]="product.name"
            class="product-image"
            (error)="onImageError($event)">
          <div class="product-overlay">
            <button mat-mini-fab color="primary" (click)="openDialog(product)" class="action-btn" matTooltip="Editar">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </button>
            <button mat-mini-fab color="warn" (click)="deleteProduct(product.id!)" class="action-btn" matTooltip="Excluir">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <polyline points="3 6 5 6 21 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </button>
          </div>
        </div>
        <div class="product-info">
          <h3 class="product-name">{{product.name}}</h3>
          <p class="product-description">{{product.description || 'Sem descrição'}}</p>
          <div class="product-footer">
            <span class="product-price">{{product.price | currency:'BRL'}}</span>
            <div class="product-badge" *ngIf="!isInCart(product.id!)">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M20 6L9 17l-5-5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
              Disponível
            </div>
            <div class="product-badge in-cart" *ngIf="isInCart(product.id!)">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M9 20a1 1 0 1 0 0 2 1 1 0 0 0 0-2zM20 20a1 1 0 1 0 0 2 1 1 0 0 0 0-2z" stroke="currentColor" stroke-width="2"/>
                <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6" stroke="currentColor" stroke-width="2"/>
              </svg>
              No Carrinho ({{ getCartQuantity(product.id!) }})
            </div>
          </div>
          <!-- Add to Cart Button -->
          <button mat-raised-button 
                  [color]="isInCart(product.id!) ? 'accent' : 'primary'" 
                  (click)="addToCart(product)" 
                  class="add-to-cart-btn">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M9 20a1 1 0 1 0 0 2 1 1 0 0 0 0-2zM20 20a1 1 0 1 0 0 2 1 1 0 0 0 0-2z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            {{ isInCart(product.id!) ? 'Adicionar Mais' : 'Adicionar ao Carrinho' }}
          </button>
        </div>
      </div>
    </div>

    <!-- Empty State -->
    <div class="empty-state" *ngIf="products.length === 0">
      <div class="empty-icon">
        <svg width="120" height="120" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <rect x="3" y="3" width="18" height="18" rx="2" stroke="url(#gradient)" stroke-width="2"/>
          <path d="M12 8v8M8 12h8" stroke="url(#gradient)" stroke-width="2" stroke-linecap="round"/>
          <defs>
            <linearGradient id="gradient" x1="0" y1="0" x2="24" y2="24" gradientUnits="userSpaceOnUse">
              <stop stop-color="#667eea"/>
              <stop offset="1" stop-color="#764ba2"/>
            </linearGradient>
          </defs>
        </svg>
      </div>
      <h2>Nenhum produto cadastrado</h2>
      <p>Comece adicionando seu primeiro produto ao catálogo</p>
      <button mat-raised-button color="primary" (click)="openDialog()" class="empty-action-btn">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
          <path d="M12 8v8M8 12h8" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
        </svg>
        Adicionar Primeiro Produto
      </button>
    </div>
  </div>
</div>
